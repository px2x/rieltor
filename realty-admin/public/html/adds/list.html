<div layout="column">
    <div layout="row" layout-xs="column">
        <md-input-container class="md-icon-float md-block" flex="13">
            <form ng-submit="loadData(true);">
                <!-- Use floating label instead of placeholder -->
                <label>Номер объявления</label>
                <input ng-model="filter.id" ng-change="loadData(true)" type="text"/>
            </form>
        </md-input-container>
        <md-input-container class="md-icon-float md-block" style="margin-left:15px;" flex="10">
            <form ng-submit="loadData(true);">
                <!-- Use floating label instead of placeholder -->
                <label>Телефон</label>
                <input ng-model="filter.phone" type="text"/>
            </form>
        </md-input-container>
        <md-input-container class="md-icon-float md-block" style="margin-left:15px;" flex="20">
            <label>Статус объявления</label>
            <md-select ng-model="filter.status" ng-change="loadData(true)">
                <md-option ng-value="">Все</md-option>
                <md-option ng-repeat="(k, st) in status" ng-value="k">
                    {{st}}
                </md-option>
            </md-select>
        </md-input-container>
        <md-input-container class="md-icon-float md-block" style="margin-left:15px;" flex="15">
            <label>Материал дома</label>
            <md-select ng-model="filter.material" ng-change="loadData(true)">
                <md-option ng-value="">Все</md-option>
                <md-option ng-repeat="(k, st) in material" ng-value="k">
                    {{st}}
                </md-option>
            </md-select>
        </md-input-container>
    </div>
    <div layout="row" layout-xs="column" style="margin-bottom:25px;">
        <md-input-container class="md-icon-float md-block" flex="20">
            <label>Тип недвижимости</label>
            <md-select ng-model="filter.type" ng-change="changeType()">
                <md-option ng-value="">Все</md-option>
                <md-option ng-repeat="(k, st) in type" ng-value="k">
                    {{st}}
                </md-option>
            </md-select>
        </md-input-container>
        <md-input-container class="md-icon-float md-block" style="margin-left:15px;" flex="20">
            <label>Подтип недвижимости</label>
            <md-select ng-model="filter.subtype" ng-disabled="!subtypes" ng-change="loadData(true)">
                <md-option ng-value="">Все</md-option>
                <md-option ng-repeat="(k, st) in subtypes" ng-value="k">
                    {{st}}
                </md-option>
            </md-select>
        </md-input-container>
    </div>
    <div layout="row" layout-xs="column">
        <div flex="25" layout="row">
            <md-input-container class="md-icon-float md-block" flex="45">
                <form ng-submit="loadData(true);">
                    <label>Цена от</label>
                    <input ng-model="filter.price_from" type="text" maxlength="9"/>
                </form>
            </md-input-container>
            <md-input-container class="md-icon-float md-block" flex="45" style="margin-left:15px;">
                <form ng-submit="loadData(true);">
                    <label>Цена до</label>
                    <input ng-model="filter.price_to" type="text" maxlength="9"/>
                </form>
            </md-input-container>
        </div>
        <div flex="30" style="margin-left:20px;" layout="row">
            <md-input-container class="md-icon-float md-block" flex="45">
                <form ng-submit="loadData(true);">
                    <label>Этажей в доме от</label>
                    <input ng-model="filter.floor_t_from" type="text" maxlength="9"/>
                </form>
            </md-input-container>
            <md-input-container class="md-icon-float md-block" flex="45" style="margin-left:15px;">
                <form ng-submit="loadData(true);">
                    <label>Этажей в доме до</label>
                    <input ng-model="filter.floor_t_to" type="text" maxlength="9"/>
                </form>
            </md-input-container>
        </div>
        <div flex="15" style="margin-left:20px;" layout="row">
            <md-input-container class="md-icon-float md-block" flex="45">
                <form ng-submit="loadData(true);">
                    <label>Этаж от</label>
                    <input ng-model="filter.floor_from" type="text" maxlength="9"/>
                </form>
            </md-input-container>
            <md-input-container class="md-icon-float md-block" flex="45" style="margin-left:15px;">
                <form ng-submit="loadData(true);">
                    <label>Этаж до</label>
                    <input ng-model="filter.floor_to" type="text" maxlength="9"/>
                </form>
            </md-input-container>
        </div>
    </div>
    <div layout="row" layout-xs="column">
        <div flex="30" layout="row">
            <md-input-container class="md-icon-float md-block" flex="45">
                <form ng-submit="loadData(true);">
                    <label>Общая площадь от</label>
                    <input ng-model="filter.sq_from" type="text" maxlength="9"/>
                </form>
            </md-input-container>
            <md-input-container class="md-icon-float md-block" flex="45" style="margin-left:15px;">
                <form ng-submit="loadData(true);">
                    <label>Общая площадь до</label>
                    <input ng-model="filter.sq_to" type="text" maxlength="9"/>
                </form>
            </md-input-container>
        </div>
        <div flex="35" style="margin-left:20px;" layout="row">
            <md-input-container class="md-icon-float md-block" flex="45">
                <form ng-submit="loadData(true);">
                    <label>Количество комнат от</label>
                    <input ng-model="filter.rooms_from" type="text" maxlength="9"/>
                </form>
            </md-input-container>
            <md-input-container class="md-icon-float md-block" flex="45" style="margin-left:15px;">
                <form ng-submit="loadData(true);">
                    <label>Количество комнат до</label>
                    <input ng-model="filter.rooms_to" type="text" maxlength="9"/>
                </form>
            </md-input-container>
        </div>
        <div flex="15" style="margin-left:20px;" layout="row">
            <md-input-container class="md-icon-float md-block" flex="100">
                <form ng-submit="loadData(true);">
                    <label>Год постройки от</label>
                    <input ng-model="filter.year" type="text" maxlength="4"/>
                </form>
            </md-input-container>
        </div>
        
    </div>
    <div layout="row" layout-xs="column" style="margin-bottom:25px;">
        <md-input-container class="md-icon-float md-block" flex="15">
            <label>Состояние жилья</label>
            <md-select ng-model="filter.condition" ng-change="loadData(true)">
                <md-option ng-value="">Все</md-option>
                <md-option ng-repeat="(k, st) in conditions" ng-value="k">
                    {{st}}
                </md-option>
            </md-select>
        </md-input-container>
        <div flex="35" style="margin-left:20px;" layout="row">
            <div flex="45">
                <md-datepicker md-max-date="maxDate" ng-change="loadData(true)" ng-model="filter.date_from" md-placeholder="Дата публикации от" md-open-on-focus></md-datepicker>
            </div>
            <div flex="45" style="margin-left:15px;">
                <md-datepicker md-max-date="maxDate" ng-change="loadData(true)" ng-model="filter.date_to" md-placeholder="Дата публикации до" md-open-on-focus></md-datepicker>
            </div>
        </div>
        <div flex="10" style="margin-left:20px;height:25px;margin-top:5px;" layout="row">
            <md-checkbox aria-label="Disabled checkbox" ng-model="filter.rent" ng-change="loadData(true)">
                Аренда
            </md-checkbox>
        </div>
        <div flex="10" style="margin-left:20px;height:25px;margin-top:5px;" layout="row">
            <md-checkbox aria-label="Disabled checkbox" ng-model="filter.warning" ng-change="loadData(true)">
                Подозрительные
            </md-checkbox>
        </div>
    </div>
    <div layout="row" layout-xs="column" style="margin-bottom:25px;">
        <md-autocomplete flex="20"
            md-items="item in searchData(developer, 'developers')"
            md-search-text="developer"
            md-selected-item="filter.developer"
            md-search-text-change="searchData(developer, 'developers')"
            md-item-text="item.name"
            md-min-length="3"
            md-max-length="10"
            placeholder="Застройщик">
            <md-item-template>
                <span md-highlight-text="name">{{item.name}}</span>
            </md-item-template>
        </md-autocomplete>
        <md-autocomplete style="margin-left:20px;" flex="20"
            md-items="item in searchData(complex, 'complexes')"
            md-search-text="complex"
            md-selected-item="filter.complex"
            md-search-text-change="searchData(complex, 'complexes')"
            md-item-text="item.name"
            md-min-length="3"
            md-max-length="10"
            placeholder="Жилищный комплекс">
            <md-item-template>
                <span md-highlight-text="name">{{item.name}}</span>
            </md-item-template>
        </md-autocomplete>
        <md-autocomplete style="margin-left:20px;" flex="20"
            md-items="item in searchData(district_m, 'districts', 'm')"
            md-search-text="district_m"
            md-selected-item="filter.district_m"
            md-search-text-change="searchData(district_m, 'districts', 'm')"
            md-item-text="item.name"
            md-min-length="3"
            md-max-length="10"
            placeholder="Муниципальный район">
            <md-item-template>
                <span md-highlight-text="name">{{item.name}}</span>
            </md-item-template>
        </md-autocomplete>
        <md-autocomplete style="margin-left:20px;" flex="20"
            md-items="item in searchData(district_o, 'districts', 'o')"
            md-search-text="district_o"
            md-selected-item="filter.district_o"
            md-search-text-change="searchData(district_o, 'districts', 'o')"
            md-item-text="item.name"
            md-min-length="3"
            md-max-length="10"
            placeholder="Общепринятый район">
            <md-item-template>
                <span md-highlight-text="name">{{item.name}}</span>
            </md-item-template>
        </md-autocomplete>
        
    </div>
    <div layout="row" layout-xs="column" style="margin-bottom:25px;">
        <md-autocomplete flex="20"
            md-items="item in searchData(street, 'streets')"
            md-search-text="street"
            md-selected-item="filter.street"
            md-search-text-change="searchData(street, 'streets')"
            md-item-text="item"
            md-min-length="3"
            md-max-length="10"
            placeholder="Улица">
            <md-item-template>
                <span md-highlight-text="name">{{item}}</span>
            </md-item-template>
        </md-autocomplete>
        <md-input-container style="margin-left:20px;" class="md-icon-float md-block" flex="5">
            <form ng-submit="loadData(true);">
                <!-- Use floating label instead of placeholder -->
                <label>Дом</label>
                <input ng-model="filter.building" type="text"/>
            </form>
        </md-input-container>
    </div>
    
    <div layout="row" layout-xs="column" style="margin-bottom:25px;">
        <md-button class="md-raised md-primary" ng-click="loadData(true)" ng-disabled="loading" style="margin-left: 0px;">
            <md-icon class="material-icons">search</md-icon>
            Найти
        </md-button>
        <md-button class="md-raised md-primary" ng-click="clearFilter()" ng-disabled="loading" style="margin-left: 0px;">
            <md-icon class="material-icons">clear</md-icon>
            Очистить фильтр
        </md-button>
        <div flex></div>
        <md-button title="" ng-href="/ads/create" class="md-fab md-mini md-primary" aria-label="Add ad" flex="none">
            <md-tooltip md-direction="top">Добавить объявление</md-tooltip>
            <md-icon class="material-icons">add</md-icon>
        </md-button>
    </div>

    <div>
        <table class="table table-hover">
            <thead>
                <tr>
                    <th class="" data-name='street'>Название</th>
                    <th class="" data-name='street'>Адрес</th>
                    <th class="nowrap fixed-width" width="40" data-name='sq'>Этаж</th>
                    <th class="nowrap fixed-width" width="40" data-name='sq' title="Год постройки дома">Год</th>
                    <th class="nowrap text-center fixed-width" width="95" data-name='sq'>Площадь</th>
                    <th class="nowrap text-center" data-name='price'>Состояние</th>
                    <th class="nowrap text-center fixed-width" width="95" data-name='price'>Стоимость</th>
                    <th class="nowrap text-center fixed-width" width="95" data-name='status'>Статус</th>
                    <th class="fixed-width" width="95"></th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="item in items">
                    <td class="ads-name">
                        <img src="/img/warning_icon.png" ng-if="item.warning" title=""/>
                        <span>{{item.name}}</span>
                    </td>
                    <td ng-bind="item.street + ', ' + item.building"></td>
                    <td>{{item.floor + '/' + item.floor_t}}</td>
                    <td>{{item.year||'-'}}</td>
                    <td ng-bind="item.sq1" class="text-center"></td>
                    <td ng-bind="conditions[item.condition]||'-'" class="text-center"></td>
                    <td class="text-center">{{formatPrice(item.price)}}</td>
                    <td ng-bind="status[item.status]||item.status" class="text-center"></td>
                    <td>
                        <div layout="row" class="buttons">
                            <a ng-href="/ads/view/{{item.id}}" title="Просмотр">
                                <md-icon class="material-icons">view_headline</md-icon>
                            </a>&nbsp;
                            <a ng-href="/ads/edit/{{item.id}}" title="Редактировать">
                                <md-icon class="material-icons">edit</md-icon>
                            </a>&nbsp;
                            <a ng-click="deleteItem(item.id)" aria-label="Remove" title="Удалить">
                                <md-icon class="material-icons">delete</md-icon>
                            </a>
                        </div>
                    </td>
                </tr>
                <tr ng-show="!loading && items.length === 0">
                    <td colspan="9" class="text-center">Объявления не найдены</td>
                </tr>
            </tbody>
        </table>
        <pagination page="filter.page" limit="filter.limit" total="total" load-data="loadData($page, $limit)"></pagination>
    </div>
</div>